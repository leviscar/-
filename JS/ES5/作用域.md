## 作用域
### 程序源代码执行三个步骤，统称为编译
1. 分词/词法分析
    1. 这个过程会将字符组成的字符串分解为有意义的代码块
2. 解析/语法分析
    1. 这个过程是将词法单元流（数组） 转换成一个由元素逐级嵌套所组成的代表了程序语法
    结构的树。 这个树被称为“抽象语法树”（Abstract Syntax Tree， AST）。
3. 代码生成
    1. 将 AST 转换为可执行代码的过程称被称为代码生成。 

### 引擎、编译器、作用域
#### 引擎
从头到尾负责整个JavaScript程序的编译以及执行过程
#### 编译器
引擎的帮手，负责语法分析以及代码生成等
#### 作用域
负责收集并维护由所有声明的标识符（变量）组成的一系列查询，并实施一套非常严格的规则，确定当前执行的代码对这些标识符的访问权限。
1. 作用域是什么？
   - 作用域就是变量与函数可访问的返回，即作用域控制变量与函数的可见性和生命周期

2. 作用域链是什么？
   - JavaScript里一切都是对象。函数对象和其它对象一样，拥有可以通过代码访问的属性和一系列仅供JavaScript引擎访问的内部属性。其中一个内部属性是[[Scope]]，由ECMA-262标准第三版定义，该内部属性包含了函数被创建的作用域中对象的集合，这个集合被称为函数的作用域链，它决定了哪些数据能被函数访问。
3. 作用域和上下文的区别
   - 执行上下文在运行时确定，随时都能改变；作用域在定义时确定，永远不会改变
   - 一个作用域下可能包含若干个上下文环境。有可能从来没有过上下文环境（函数从来就没有被调用过）；有可能有过，现在函数被调用完毕后，上下文环境被销毁了；有可能同时存在一个或多个（闭包）。

### eval/with 性能影响
- eval、with都会欺骗词法作用域
- JavaScript引擎在编译阶段会进行数项性能优化。其中有些优化依赖于能够根据代码的词法进行静态分析，并预先确定所有变量和函数的定义位置，才能在执行过程中快速找到标识符。
- 但是如果引擎在代码中发现eval/with，它只能简单地假设关于标识符位置的判断都是无效的。
- 最悲观的情况是如果出现了eval/with，所有的优化可能都是无意义的，因此最简单的做法就是完全不做任何优化。